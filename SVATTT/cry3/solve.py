from z3 import *
from Crypto.Util.number import long_to_bytes

p = 140513998383733505878882484463832810400773610216464396082090299095443413923172235117457913756664550823719549662902317573376081431193542463845487697907226369167600481120163289426938922732100465539059713541309125384262046419688008790735321015697953751228026907656116801742757145900027205145531958711127892554959
g = 65556906335252739492138792165542310729847274604215491204377659859487941883331877324828668014945205688539538625347791245434017456867211045274632515903354031987751781443770705945360580464425457828577976457587248703877110979526996451487269992053016854914380845578885990371833497436103486601509329626084083968660
h = 15273528733818364088944825564931416580246804828551511408185386076550844914061247386402976630878359077550812761024414293357647284108322195874431618705318411581501804308347288296685298101428242754270584056686889362688314067600725185045055940503536863894910812191441369971393731456033180082689578691282489630975
(c1, c2) = (32930763137657591245671682661065378907876157470073696324706860924174151413813899545628267737923954182518355580308482582884395083978855627014399016379054293488253402225390954280471448716452508005409111284576745690532031769595122489477338312943614861813951717110271786478521584713391571602054127763725617981811,
            7670001641599113231861941980345322847092796276245234617022952335365852477157226432010123907328990528181522443870120480148135852521715550020767705947636650531440958788351061564446985872556473800469658897282244374663426300248809407921886806704736303693384639428103469288766910384891882482020192891012087623322)
y = Int('y')
m = Int('m')
x = Solver()
x.add(g * y % p == c1)
x.check()
y_a = x.model()[y].as_long()
s = pow(h, y_a, p)
v = Solver()
v.add(m * s % p == c2)
v.add(m > 0)
v.check()
print(long_to_bytes(v.model()[m].as_long()))
